jobs:
  Job1:
    name: Windows VM with RDP
    runs-on: Windows-Server-2022-Medium
    steps:
      - type: powershell
        name: Set Administrator Password
        script: |
          Write-Host "üîë Thi·∫øt l·∫≠p m·∫≠t kh·∫©u cho Administrator..."
          $password = ConvertTo-SecureString "Xy!9#2025_RdpStrong*" -AsPlainText -Force
          Set-LocalUser -Name "Administrator" -Password $password
          Enable-LocalUser -Name "Administrator"

      - type: powershell
        name: Open Pinggy Tunnel (RDP 3389)
        script: |
          Write-Host "üöÄ M·ªü tunnel Pinggy SSH (RDP 3389)..."
          & "C:\Program Files\Git\usr\bin\ssh.exe" -p 443 -R0:localhost:3389 -o StrictHostKeyChecking=no -o ServerAliveInterval=30 lVuaQjAzw82+tcp@free.pinggy.io

      - type: powershell
        name: Keep VM Alive
        script: |
          Write-Host "‚è≥ Gi·ªØ VM ch·∫°y v√≤ng l·∫∑p..."
          for ($i=0; $i -lt 360; $i++) {
            Start-Sleep -Seconds 60
            Write-Host "ƒêang gi·ªØ: $i ph√∫t (t·ªïng $($i/60) gi·ªù)"
          }
